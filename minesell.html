<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MineSell</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      font-family: sans-serif;
    }
    #inventory {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(0,0,0,0.7);
      color: white;
      padding: 10px;
      border-radius: 8px;
    }
    #tooltip {
      position: absolute;
      background: black;
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 14px;
      pointer-events: none;
      display: none;
    }
  </style>
</head>
<body>
  <canvas id="game"></canvas>
  <div id="inventory"></div>
  <div id="tooltip"></div>

  <script>
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const BLOCK_SIZE = 40;
    const WORLD_WIDTH = 50;
    const WORLD_HEIGHT = 20;
    const world = [];
    const inventory = {};
    const player = {
      x: 5,
      y: 0,
      width: 2,
      height: 2,
      color: "orange",
      vy: 0,
      grounded: false
    };

    const blockTypes = ["dirt", "grass", "stone", "coal", "iron", "diamond", "wood"];
    const colors = {
      dirt: "#8B4513",
      grass: "#228B22",
      stone: "#808080",
      coal: "#333333",
      iron: "#c0c0c0",
      diamond: "#00ffff",
      wood: "#a0522d"
    };

    function generateWorld() {
      for (let y = 0; y < WORLD_HEIGHT; y++) {
        const row = [];
        for (let x = 0; x < WORLD_WIDTH; x++) {
          let block = null;
          if (y === WORLD_HEIGHT - 1) {
            block = "grass";
          } else if (y > WORLD_HEIGHT - 5) {
            const r = Math.random();
            if (r < 0.02) block = "diamond";
            else if (r < 0.07) block = "iron";
            else if (r < 0.15) block = "coal";
            else block = "stone";
          } else if (y > WORLD_HEIGHT - 7) {
            block = "dirt";
          } else if (Math.random() < 0.05 && y > 2 && y < WORLD_HEIGHT - 4) {
            block = "wood"; // trees
          } else {
            block = null;
          }
          row.push(block);
        }
        world.push(row);
      }
    }

    function drawWorld() {
      for (let y = 0; y < WORLD_HEIGHT; y++) {
        for (let x = 0; x < WORLD_WIDTH; x++) {
          const block = world[y][x];
          if (block) {
            ctx.fillStyle = colors[block] || "gray";
            ctx.fillRect(x * BLOCK_SIZE, y * BLOCK_SIZE, BLOCK_SIZE, BLOCK_SIZE);
          }
        }
      }
    }

    function drawPlayer() {
      ctx.fillStyle = player.color;
      ctx.fillRect(player.x * BLOCK_SIZE, player.y * BLOCK_SIZE, player.width * BLOCK_SIZE, player.height * BLOCK_SIZE);
    }

    function updateInventory(block) {
      inventory[block] = (inventory[block] || 0) + 1;
      renderInventory();
    }

    function renderInventory() {
      const invDiv = document.getElementById("inventory");
      invDiv.innerHTML = "<strong>Inventory</strong><br>";
      for (const block in inventory) {
        invDiv.innerHTML += `${block}: ${inventory[block]}<br>`;
      }
    }

    function getMouseBlock(e) {
      const rect = canvas.getBoundingClientRect();
      const x = Math.floor((e.clientX - rect.left) / BLOCK_SIZE);
      const y = Math.floor((e.clientY - rect.top) / BLOCK_SIZE);
      if (world[y] && world[y][x]) {
        return { block: world[y][x], x, y };
      }
      return null;
    }

    canvas.addEventListener("mousemove", (e) => {
      const data = getMouseBlock(e);
      const tooltip = document.getElementById("tooltip");
      if (data) {
        tooltip.style.left = e.clientX + 10 + "px";
        tooltip.style.top = e.clientY + 10 + "px";
        tooltip.innerText = data.block;
        tooltip.style.display = "block";
      } else {
        tooltip.style.display = "none";
      }
    });

    canvas.addEventListener("click", (e) => {
      const data = getMouseBlock(e);
      if (data) {
        updateInventory(data.block);
        world[data.y][data.x] = null;
      }
    });

    document.addEventListener("keydown", (e) => {
      if (e.key === "ArrowRight") player.x++;
      if (e.key === "ArrowLeft") player.x--;
      if (e.key === " " && player.grounded) {
        player.vy = -1.5;
        player.grounded = false;
      }
    });

    function applyGravity() {
      player.vy += 0.1;
      player.y += player.vy;

      const below = world[Math.floor(player.y + player.height)]?.[player.x];
      if (below) {
        player.y = Math.floor(player.y);
        player.vy = 0;
        player.grounded = true;
      }
    }

    function gameLoop() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawWorld();
      applyGravity();
      drawPlayer();
      requestAnimationFrame(gameLoop);
    }

    generateWorld();
    renderInventory();
    gameLoop();
  </script>
</body>
</html>
